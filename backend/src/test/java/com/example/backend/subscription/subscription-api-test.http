### 참고: 아래 테스트는 SQL 테스트 데이터를 기반으로 작성되었습니다.
### - 채널 ID: 1(프로그래밍 기초), 2(웹 개발), 3(디자인), 4(데이터 분석)
### - 크리에이터 ID: 3, 4
### - 멤버 ID: 1(일반사용자1), 2(일반사용자2), 6(OAuth사용자)
### - 구독 플랜 ID: 1~8

### 변수 설정
@baseUrl = http://localhost:8080

### ============================================
### ✅ 1. 구독 상품 등록 (CRUD) - 구현 완료
### 엔드포인트: POST /api/channels/{channelId}/plans
### ============================================

### 채널 1에 월간 구독 플랜 생성 (크리에이터 3)
### SQL 데이터: plan_id 1 (MONTHLY, 19900)
POST {{baseUrl}}/api/channels/1/plans?creatorId=3
Content-Type: application/json

{
  "planType": "MONTHLY",
  "price": 19900
}

### 채널 1에 연간 구독 플랜 생성 (크리에이터 3)
### SQL 데이터: plan_id 2 (YEARLY, 199000)
POST {{baseUrl}}/api/channels/1/plans?creatorId=3
Content-Type: application/json

{
  "planType": "YEARLY",
  "price": 199000
}

### 채널 2에 월간 구독 플랜 생성 (크리에이터 3)
### SQL 데이터: plan_id 3 (MONTHLY, 29900)
POST {{baseUrl}}/api/channels/2/plans?creatorId=3
Content-Type: application/json

{
  "planType": "MONTHLY",
  "price": 29900
}

### 채널 2에 연간 구독 플랜 생성 (크리에이터 3)
### SQL 데이터: plan_id 4 (YEARLY, 299000)
POST {{baseUrl}}/api/channels/2/plans?creatorId=3
Content-Type: application/json

{
  "planType": "YEARLY",
  "price": 299000
}

### 채널 3에 월간 구독 플랜 생성 (크리에이터 4)
### SQL 데이터: plan_id 5 (MONTHLY, 14900)
POST {{baseUrl}}/api/channels/3/plans?creatorId=4
Content-Type: application/json

{
  "planType": "MONTHLY",
  "price": 14900
}

### 채널 3에 연간 구독 플랜 생성 (크리에이터 4)
### SQL 데이터: plan_id 6 (YEARLY, 149000)
POST {{baseUrl}}/api/channels/3/plans?creatorId=4
Content-Type: application/json

{
  "planType": "YEARLY",
  "price": 149000
}

### 채널 4에 월간 구독 플랜 생성 (크리에이터 4)
### SQL 데이터: plan_id 7 (MONTHLY, 24900)
POST {{baseUrl}}/api/channels/4/plans?creatorId=4
Content-Type: application/json

{
  "planType": "MONTHLY",
  "price": 24900
}

### 채널 4에 연간 구독 플랜 생성 (크리에이터 4)
### SQL 데이터: plan_id 8 (YEARLY, 249000)
POST {{baseUrl}}/api/channels/4/plans?creatorId=4
Content-Type: application/json

{
  "planType": "YEARLY",
  "price": 249000
}

### 구독 상품 생성 테스트 (creatorId 생략 - 기본값 1L 사용)
POST {{baseUrl}}/api/channels/1/plans
Content-Type: application/json

{
  "planType": "MONTHLY",
  "price": 29900
}

### ============================================
### ✅ 4. 구독 상품 조회 (CRUD) - 구현 완료
### 엔드포인트: GET /api/channels/{channelId}/plans
### ============================================

### 채널 1 (프로그래밍 기초 강의)의 구독 상품 조회
GET {{baseUrl}}/api/channels/1/plans

### 채널 2 (웹 개발 마스터)의 구독 상품 조회
GET {{baseUrl}}/api/channels/2/plans

### 채널 3 (디자인 튜토리얼)의 구독 상품 조회
GET {{baseUrl}}/api/channels/3/plans

### 채널 4 (데이터 분석 강의)의 구독 상품 조회
GET {{baseUrl}}/api/channels/4/plans

### ============================================
### ✅ 5. 구독 신청 (PROCESS) - 구현 완료
### 엔드포인트: POST /api/channels/{channelId}/subscriptions?planId={planId}
### ✅ 10. 중복 구독 방지 (POLICY) - 구현 완료 (구독 신청 시 자동 처리)
### ============================================

### 멤버 1이 채널 1의 플랜 1(월간) 구독 신청
### SQL 데이터: member_id 1, channel_id 1, plan_id 1 (ACTIVE)
POST {{baseUrl}}/api/channels/1/subscriptions?memberId=1&planId=1

### 멤버 1이 채널 2의 플랜 3(월간) 구독 신청
### SQL 데이터: member_id 1, channel_id 2, plan_id 3 (ACTIVE)
POST {{baseUrl}}/api/channels/2/subscriptions?memberId=1&planId=3

### 멤버 2가 채널 1의 플랜 2(연간) 구독 신청
### SQL 데이터: member_id 2, channel_id 1, plan_id 2 (ACTIVE)
POST {{baseUrl}}/api/channels/1/subscriptions?memberId=2&planId=2

### 멤버 2가 채널 3의 플랜 5(월간) 구독 신청
### SQL 데이터: member_id 2, channel_id 3, plan_id 5 (EXPIRED)
POST {{baseUrl}}/api/channels/3/subscriptions?memberId=2&planId=5

### 멤버 6(OAuth 사용자)이 채널 2의 플랜 4(연간) 구독 신청
### SQL 데이터: member_id 6, channel_id 2, plan_id 4 (ACTIVE)
POST {{baseUrl}}/api/channels/2/subscriptions?memberId=6&planId=4

### 멤버 6이 채널 4의 플랜 7(월간) 구독 신청
### SQL 데이터: member_id 6, channel_id 4, plan_id 7 (CANCELED)
POST {{baseUrl}}/api/channels/4/subscriptions?memberId=6&planId=7

### 구독 신청 테스트 (memberId 생략 - 기본값 1L 사용)
POST {{baseUrl}}/api/channels/1/subscriptions?planId=1

### ============================================
### ✅ 10. 중복 구독 방지 테스트 (POLICY) - 구현 완료
### 동일 채널에 활성 구독이 있으면 DUPLICATE_ACTIVE_SUBSCRIPTION 예외 발생
### ============================================

### 멤버 1이 이미 채널 1에 활성 구독이 있는 상태에서 다시 구독 시도 (실패 예상)
POST {{baseUrl}}/api/channels/1/subscriptions?memberId=1&planId=2

### 멤버 1이 이미 채널 2에 활성 구독이 있는 상태에서 다시 구독 시도 (실패 예상)
POST {{baseUrl}}/api/channels/2/subscriptions?memberId=1&planId=4

### ============================================
### ✅ 9. 내 구독 목록 조회 (CRUD) - 구현 완료
### 엔드포인트: GET /api/subscriptions/me
### ============================================

### 멤버 1의 구독 목록 조회
### SQL 데이터: 채널 1(플랜 1, ACTIVE), 채널 2(플랜 3, ACTIVE)
GET {{baseUrl}}/api/subscriptions/me?memberId=1

### 멤버 2의 구독 목록 조회
### SQL 데이터: 채널 1(플랜 2, ACTIVE), 채널 3(플랜 5, EXPIRED)
GET {{baseUrl}}/api/subscriptions/me?memberId=2

### 멤버 6(OAuth 사용자)의 구독 목록 조회
### SQL 데이터: 채널 2(플랜 4, ACTIVE), 채널 4(플랜 7, CANCELED)
GET {{baseUrl}}/api/subscriptions/me?memberId=6

### 내 구독 목록 조회 테스트 (memberId 생략 - 기본값 1L 사용)
GET {{baseUrl}}/api/subscriptions/me

### ============================================
### 추가 테스트 시나리오
### ============================================

### 멤버 2가 채널 2의 플랜 3(월간) 구독 신청 (새 구독)
POST {{baseUrl}}/api/channels/2/subscriptions?memberId=2&planId=3

### 멤버 1이 채널 3의 플랜 6(연간) 구독 신청 (새 구독)
POST {{baseUrl}}/api/channels/3/subscriptions?memberId=1&planId=6

### 멤버 6이 채널 1의 플랜 2(연간) 구독 신청 (새 구독)
POST {{baseUrl}}/api/channels/1/subscriptions?memberId=6&planId=2
